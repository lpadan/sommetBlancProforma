<script>

    $(document).ready(function(){
        $('.tabs').tabs();
    });

    $('#editConstructionBtn').click(function(e) {
        e.preventDefault();
        $('#displayConstructionBtns').hide();
        $('#editConstructionBtns').show();
        $('.construction-display').hide();
        $('.construction-edit').show();
    });

    $('#editConstructionCancelBtn').click(function(e) {
        e.preventDefault();
        $('#displayConstructionBtns').show();
        $('#editConstructionBtns').hide();
        $('.construction-display').show();
        $('.construction-edit').hide();
    });


    $('#editRevenueBtn').click(function(e) {
        e.preventDefault();
        $('#displayRevenueBtns').hide();
        $('#editRevenueBtns').show();
        $('.revenue-display').hide();
        $('.revenue-edit').show();
    });

    $('#editRevenueCancelBtn').click(function(e) {
        e.preventDefault();
        $('#displayRevenueBtns').show();
        $('#editRevenueBtns').hide();
        $('.revenue-display').show();
        $('.revenue-edit').hide();
    });

    $('#editLoanBtn').click(function(e) {
        e.preventDefault();
        $('#displayLoanBtns').hide();
        $('#editLoanBtns').show();
        $('.loan-display').hide();
        $('.loan-edit').show();
    });

    $('#editLoanCancelBtn').click(function(e) {
        e.preventDefault();
        $('#displayLoanBtns').show();
        $('#editLoanBtns').hide();
        $('.loan-display').show();
        $('.loan-edit').hide();
    });

        $('#editExpenseBtn').click(function(e) {
        e.preventDefault();
        $('#displayExpenseBtns').hide();
        $('#editExpenseBtns').show();
        $('.expense-display').hide();
        $('.expense-edit').show();
    });

    $('#editExpenseCancelBtn').click(function(e) {
        e.preventDefault();
        $('#displayExpenseBtns').show();
        $('#editExpenseBtns').hide();
        $('.expense-display').show();
        $('.expense-edit').hide();
    });

    $('#addExpenseBtn').click(function() {
        addExpenseModal.open();
    });

    $('#deleteExpenseBtn').click(function() {
        deleteExpenseModal.open();
    });

    $('#expenseCategory').change(function() {

    });

    $('#editExpenseSaveBtn').click(function(e) {

        e.preventDefault();
        $(this).text('saving...');
        var expenses={},temp=[],val='',displayVal='',type='';
        expenses.land = [];
        expenses.hardCosts = [];
        expenses.softCosts = [];

        // get land values
        $('#land li').each(function() {
            temp = [];
            $(this).find('.land-expense').each(function() {
                type = $(this).attr('type');
                val = $(this).val();
                if (type == 'number') displayVal = formatNumber(val);
                else displayVal = val;
                $(this).prev().text(displayVal)
                if (!val) val = '';
                temp.push(val);
            });
            expenses.land.push(temp);
        });

        // get hard cost values
        $('#hardCosts li').each(function() {
            temp = [];
            $(this).find('.hard-cost-expense' ).each(function() {
                type = $(this).attr('type');
                val = $(this).val();
                if (type == 'number') displayVal = formatNumber(val);
                else displayVal = val;
                $(this).prev().text(displayVal)
                if (!val) val = '';
                temp.push(val);
            });
            expenses.hardCosts.push(temp);
        });

        // get soft cost values
        $('#softCosts li').each(function() {
            temp = [];
            $(this).find('.soft-cost-expense' ).each(function() {
                type = $(this).attr('type');
                val = $(this).val();
                if (type == 'number') displayVal = formatNumber(val);
                else displayVal = val;
                $(this).prev().text(displayVal)
                if (!val) val = '';
                temp.push(val);
            });
            expenses.softCosts.push(temp);
        });

        google.script.run.withUserObject(this).withSuccessHandler(successSaveExpenses).saveExpenses(expenses);

    });

    function successSaveExpenses(data,button) {
        $(button).text("Save");
        $('#editExpenseCancelBtn').click();
    }

    function formatNumber(number) {
        if (!number)return '';
        temp = Number(number);
        if (number < 1 && number > -1) return ''; // test for fractional numbers
        var formatted_value = temp.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
        return formatted_value;
    }



</script>